<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Visual Analytics</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

</head>

<body class="background">

  <!-- Container -->
  <div class="container-fluid background">

    <!-- row menu -->
    <div class="row justify-content-center align-items-center g-2">
      <!-- colonna reset filtri -->
      <div class="col-1 px-3 py-2">
          <button type="button" class="btn btn-outline-danger" onclick="notifyWrapper()">Reset Filters</button>
      </div>
      <!-- colonna slect year -->
      <div class="col-3 px-3 py-2">
        <label class="text-white" for="datasetYear">Select Year</label>

        <!-- style year slider -->
        <style>
          #year-labels {
            color: rgb(155, 155, 155);
            display: flex;
            justify-content: space-between;
            font-size: 14px;
          }
        </style>
        <!-- year slider -->
        <input type="range" id="datasetYear" name="datasetYear" min="2011" max="2021" value="2011" class="form-range">
        <div id="year-labels">
          <span>2011</span>
          <span>2012</span>
          <span>2013</span>
          <span>2014</span>
          <span>2015</span>
          <span>2016</span>
          <span>2017</span>
          <span>2018</span>
          <span>2019</span>
          <span>2020</span>
          <span>2021</span>
        </div>
        <!-- script slider year -->
        <script>
          const slider = document.getElementById('datasetYear');
          const sliderTicks = document.getElementById('sliderTicks');
          const ticks = sliderTicks.querySelectorAll('.sliderTick');
    
          slider.addEventListener('input', () => {
            const percent = (slider.value - slider.min) / (slider.max - slider.min);
            const tickIndex = Math.round((ticks.length - 1) * percent);
            ticks.forEach((tick, index) => {
              if (index === tickIndex) {
                tick.classList.add('active');
              } else {
                tick.classList.remove('active');
              }
            });
          });
        </script>

      </div>
      <!-- colonna xField -->
      <div class="col-2 px-3 py-2">
        <!-- xField button -->
        <label class="text-white" for="datasetXField">First Dimension (X)</label>
        <select id="datasetXField" class="form-control">
          <option selected value="Life_Expectancy_at_Birth">Life Expectancy at Birth</option>
          <option value="Human_Development_Index">Human Development Index</option>
          <option value="Expected_Years_of_Schooling">Expected Years of Schooling</option>
          <option value="Mean_Years_of_Schooling">Mean Years of Schooling</option>
          <option value="Gross_National_Income_Per_Capita">Gross National Income Per Capita</option>
          <option value="Gender_Development_Index">Gender Development Index</option>
          <option value="HDI_female">HDI female</option>
          <option value="HDI_male">HDI male</option>
          <option value="Inequality-adjusted_Human_Development_Index">Inequality-adjusted Human Development Index</option>
          <option value="Coefficient_of_human_inequality">Coefficient of human inequality</option>
          <option value="Overall_loss_%">Overall loss %</option>
          <option value="Inequality_in_life_expectancy">Inequality in life expectancy</option>
          <option value="Inequality_in_eduation">Inequality in eduation</option>
          <option value="Inequality_in_income">Inequality in income</option>
          <option value="Gender_Inequality_Index">Gender Inequality Index</option>
        </select>
      </div>
      <!-- colonna yField -->
      <div class="col-2 px-3 py-2">
        <!-- yField button -->
        <label class="text-white" for="datasetYField">Second Dimension (Y)</label>
        <select id="datasetYField" class="form-control">
          <option value="Human_Development_Index">Human Development Index</option>
          <option value="Life_Expectancy_at_Birth">Life Expectancy at Birth</option>
          <option value="Expected_Years_of_Schooling">Expected Years of Schooling</option>
          <option value="Mean_Years_of_Schooling">Mean Years of Schooling</option>
          <option selected value="Gross_National_Income_Per_Capita">Gross National Income Per Capita</option>
          <option value="Gender_Development_Index">Gender Development Index</option>
          <option value="HDI_female">HDI female</option>
          <option value="HDI_male">HDI male</option>
          <option value="Inequality-adjusted_Human_Development_Index">Inequality-adjusted Human Development Index</option>
          <option value="Coefficient_of_human_inequality">Coefficient of human inequality</option>
          <option value="Overall_loss_%">Overall loss %</option>
          <option value="Inequality_in_life_expectancy">Inequality in life expectancy</option>
          <option value="Inequality_in_eduation">Inequality in eduation</option>
          <option value="Inequality_in_income">Inequality in income</option>
          <option value="Gender_Inequality_Index">Gender Inequality Index</option>
        </select>
      </div>
      <!-- colonna zField -->
      <div class="col-1 px-3 py-2">
        <!-- zField button -->
        <label class="text-white" for="datasetZField">Bubble Radius</label>
        <select id="datasetZField" class="form-control">
          <option value="default">Default</option>
          <option selected value="Population">Population</option>
          <option value="Human_Development_Index">Human Development Index</option>
          <option value="Life_Expectancy_at_Birth">Life Expectancy at Birth</option>
          <option value="Expected_Years_of_Schooling">Expected Years of Schooling</option>
          <option value="Mean_Years_of_Schooling">Mean Years of Schooling</option>
          <option value="Gross_National_Income_Per_Capita">Gross National Income Per Capita</option>
          <option value="Gender_Development_Index">Gender Development Index</option>
          <option value="HDI_female">HDI female</option>
          <option value="HDI_male">HDI male</option>
          <option value="Inequality-adjusted_Human_Development_Index">Inequality-adjusted Human Development Index</option>
          <option value="Coefficient_of_human_inequality">Coefficient of human inequality</option>
          <option value="Overall_loss_%">Overall loss %</option>
          <option value="Inequality_in_life_expectancy">Inequality in life expectancy</option>
          <option value="Inequality_in_eduation">Inequality in eduation</option>
          <option value="Inequality_in_income">Inequality in income</option>
          <option value="Gender_Inequality_Index">Gender Inequality Index</option>
        </select>
      </div>
      <!-- colonna correlazione -->
      <div class="col-3 px-3 py-3 text-white">
        <button type="button" class="btn btn-outline-primary mt-4" onclick="reloadCorrelationWrapper()">Compute correlation</button>
      </div>
    </div>
    <!-- end row menu -->

    <!-- row correlation -->
    <div class="row">
      <div class="col-12 text-white pb-1">
        <!-- risultati calcolo correlazione -->
        <span id="correlation"></span>
        <span id="minCorrelation"></span>
        <span id="maxCorrelation"></span>
      <!--
        <p id="correlation"></p>
        <p id="minCorrelation"></p>
        <p id="maxCorrelation"></p>
        -->
      </div>
    </div>
    <!-- end row correlation-->


    <!-- Row 1 -->
    <div class="row justify-content-center align-items-center g-2">

      <!-- Column 1  -->
      <div class="col-4 column">
        <h4 class="text-white">MDS</h4>
        
        <!-- ScatterPlot -->
        <div id="scatterplotMDS"></div>
      </div>
      <!-- End Column 1 -->

      <!-- Column 2 -->
      <div class="col-4 column">
        <h4 class="text-white">Bubble Plot</h4>        

        <!-- Bubble Plot -->
        <div id="bubbleplot"></div>

      </div>
      <!-- End Column 2 -->

      <!-- Column 3 -->
      <div class="col-4 column">
        <h4 class="text-white">World Map</h4>
        <div id="worldmap"></div>
      </div>
      <!-- End Column 3 -->

    </div>
    <!-- End Row 1 -->

    <!-- Row 2-->
    <div class="row">
      <!-- column 1-->
      <div class="col-12 column">
        <h4 class="text-white">Parallel Coordinates</h4>
        <!-- Parallel Coordinates -->
        <div id="parallelcoordinates"></div>
      </div>
      <!-- End column 1-->

    </div>
    <!-- End Row 2-->

  </div>
  <!-- End Container -->



  <!-- Load Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>

  <!-- Style Dashboard -->
  <style>

    .background {
      background-color: #252525ee;
    }
    .column {
      border: 5px solid rgba(160, 158, 158, 0.315);
    }
  </style>

  <!-- Load d3.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
	<script src="https://d3js.org/d3-transition.v2.min.js"></script>

  <!-- import plot world map -->
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
  
  <!-- Parallel Coordinates -->
  <script type="module" src="script_js/index.js"></script>

  
  <!-- Style parallel coordinates -->
  <style>

    div.parallelCoordinates{
      margin: 2em;
    }

    g.inactive path, g.active path{
      fill: none;
      stroke: rgba(160, 158, 158, 0.178);
      stroke-linecap:"round"
    }
    g.active path{
      stroke:#77b9cfe0;
    }

  </style>

  <!-- class wrapper per chiamare le funzioni nei moduli -->
  <script>
    function updateDatasetParallCoordWrapper() {
      updateDatasetParallCoord(0);
    }

    function updateDatasetWrapper() {
      updateDataset();
    }

    function notifyWrapper(){
      observableManager.notifyObservables(0);
      updateDatasetParallCoordWrapper();
    }

    function reloadCorrelationWrapper() {
      let xField = document.getElementById("datasetXField").value;
      let yField = document.getElementById("datasetYField").value;
      reloadCorrelation(observableManager._filteredData, xField, yField);
    }

    document.getElementById("datasetYear").addEventListener("change", updateDatasetParallCoordWrapper);
    document.getElementById("datasetXField").addEventListener("change", updateDatasetWrapper);
    document.getElementById("datasetYField").addEventListener("change", updateDatasetWrapper);
    document.getElementById("datasetZField").addEventListener("change", updateDatasetWrapper);
    window.onresize = notifyWrapper;
    
  </script>

</body>

</html>
